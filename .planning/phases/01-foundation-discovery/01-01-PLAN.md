---
phase: 01-foundation-discovery
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - tsconfig.json
  - src/types/index.ts
  - src/config/schema.ts
  - src/config/defaults.ts
autonomous: true

must_haves:
  truths:
    - "TypeScript project compiles without errors"
    - "Config schema validates correct YAML"
    - "Config schema rejects invalid YAML with helpful errors"
    - "Default values are applied for missing config fields"
  artifacts:
    - path: "package.json"
      provides: "Project dependencies and scripts"
      contains: "fast-glob"
    - path: "tsconfig.json"
      provides: "TypeScript configuration"
      contains: "strict"
    - path: "src/config/schema.ts"
      provides: "Zod schema for config validation"
      exports: ["ConfigSchema", "Config"]
    - path: "src/config/defaults.ts"
      provides: "Default configuration values"
      exports: ["DEFAULT_CONFIG"]
  key_links:
    - from: "src/config/schema.ts"
      to: "zod"
      via: "import"
      pattern: "import.*zod"
---

<objective>
Initialize the TypeScript project and create the configuration schema.

Purpose: Establish the foundation for all subsequent plans - package dependencies, TypeScript config, and the Zod schema that validates `.agents-reverse/config.yaml`.

Output: Compilable TypeScript project with config schema ready for use by loader and CLI.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-foundation-discovery/01-CONTEXT.md
@.planning/phases/01-foundation-discovery/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Initialize TypeScript project with dependencies</name>
  <files>package.json, tsconfig.json</files>
  <action>
Create package.json with:
- name: "agents-reverse"
- type: "module" (ESM)
- bin: { "agents-reverse": "./dist/cli/index.js", "ar": "./dist/cli/index.js" }
- scripts: build (tsc), dev (tsx watch), test (vitest)
- dependencies from RESEARCH.md: fast-glob, ignore, isbinaryfile, yaml, zod, picocolors, ora, simple-git
- devDependencies: typescript, tsx, vitest, @types/node

Create tsconfig.json with:
- target: ES2022
- module: NodeNext
- moduleResolution: NodeNext
- strict: true
- outDir: dist
- rootDir: src
- declaration: true

Run `npm install` to install dependencies.
  </action>
  <verify>
`npm run build` compiles without errors (even if src is empty or minimal).
`ls node_modules | grep -E "fast-glob|ignore|zod"` shows all deps installed.
  </verify>
  <done>
package.json and tsconfig.json exist, `npm install` succeeded, `npm run build` runs (may have no output yet).
  </done>
</task>

<task type="auto">
  <name>Task 2: Create shared types and config schema</name>
  <files>src/types/index.ts, src/config/schema.ts, src/config/defaults.ts</files>
  <action>
Create src/types/index.ts:
- Export shared types used across modules
- DiscoveryResult type: { files: string[], excluded: ExcludedFile[] }
- ExcludedFile type: { path: string, reason: string }
- LogLevel enum or type: 'verbose' | 'normal' | 'quiet'

Create src/config/schema.ts following RESEARCH.md Pattern 4:
- Import z from 'zod'
- ConfigSchema with nested objects:
  - exclude: { patterns: string[], vendorDirs: string[], binaryExtensions?: string[] }
  - options: { followSymlinks: boolean, maxFileSize: number }
  - output: { colors: boolean, verbose: boolean }
- All fields have sensible defaults via .default()
- Export ConfigSchema and inferred Config type

Create src/config/defaults.ts:
- DEFAULT_VENDOR_DIRS: node_modules, vendor, .git, dist, build, __pycache__, .next, venv, .venv, target, .cargo, .gradle
- DEFAULT_BINARY_EXTENSIONS: .png, .jpg, .jpeg, .gif, .bmp, .ico, .webp, .zip, .tar, .gz, .rar, .7z, .exe, .dll, .so, .dylib, .mp3, .mp4, .wav, .pdf, .woff, .woff2, .ttf, .eot, .class, .pyc
- DEFAULT_MAX_FILE_SIZE: 1024 * 1024 (1MB per CONTEXT.md)
- Export DEFAULT_CONFIG object matching schema structure
  </action>
  <verify>
`npm run build` succeeds.
`npx tsx -e "import { ConfigSchema } from './src/config/schema.js'; console.log(ConfigSchema.parse({}))"` outputs default config object.
  </verify>
  <done>
Types compile. ConfigSchema.parse({}) returns full default config. ConfigSchema.parse({ exclude: { patterns: ['*.log'] } }) merges with defaults.
  </done>
</task>

</tasks>

<verification>
1. `npm run build` produces dist/ with compiled JS
2. `npx tsx -e "import { ConfigSchema } from './src/config/schema.js'; const c = ConfigSchema.parse({}); console.log(c.exclude.vendorDirs.length > 5)"` outputs true
3. `npx tsx -e "import { ConfigSchema } from './src/config/schema.js'; ConfigSchema.parse({ exclude: { patterns: 123 } })"` throws ZodError (invalid type)
</verification>

<success_criteria>
- TypeScript project compiles
- All dependencies from RESEARCH.md installed
- ConfigSchema validates and provides defaults
- Types exported for use by other modules
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-discovery/01-01-SUMMARY.md`
</output>
